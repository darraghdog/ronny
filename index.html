<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Ronny - Python Challenges for Leaving Cert CS</title>
<script src="https://skulpt.org/js/skulpt.min.js"></script>
<script src="https://skulpt.org/js/skulpt-stdlib.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&family=Fira+Code:wght@400;700&display=swap">
<style>

  :root {
    --accent-pink: #e75e8d;
    --accent-pink-light: #ec6090;
    --neon-blue: #5bc0de;
    --success-green: #4caf50;
    --neon-yellow: #ffd700;
    --neon-orange: #ff6b00;
    --neon-purple: #9b59b6;
    --dark-bg: #1e1e1e;
    --panel-bg: #27292a;
    --panel-border: #3a3a3a;
    --text-light: #ffffff;
    --text-muted: #b0b0b0;
    --gold: #ffd700;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  html, body {
    overflow-x: hidden;
    width: 100%;
    max-width: 100vw;
  }

  body {
    background: var(--dark-bg);
    color: var(--text-light);
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
  }

  body::before {
    content: '';
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background-image: radial-gradient(circle, #333 1px, transparent 1px);
    background-size: 30px 30px;
    z-index: -1;
    opacity: 0.3;
  }

  body::after {
    content: '';
    position: fixed; top: -50%; right: 0;
    width: 50%; height: 120%;
    background: linear-gradient(135deg, rgba(231,94,141,0.06) 0%, transparent 60%);
    z-index: -1;
    pointer-events: none;
  }

  /* HEADER */
  .header {
    background: var(--panel-bg);
    border-bottom: 2px solid var(--panel-border);
    padding: 10px 20px;
    display: flex; align-items: center; justify-content: space-between;
    position: relative; z-index: 10;
  }

  .logo { display: flex; align-items: center; gap: 12px; cursor: pointer; }
  .logo-icon { font-size: 36px; }
  .logo-text {
    font-family: 'Poppins', sans-serif; font-size: 32px; font-weight: 700;
    background: linear-gradient(135deg, var(--accent-pink), var(--neon-blue));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    letter-spacing: 3px;
  }
  .logo-sub { font-size: 11px; color: var(--text-muted); letter-spacing: 4px; }

  .stats-bar { display: flex; align-items: center; gap: 20px; }
  .stat-item {
    display: flex; align-items: center; gap: 6px;
    font-family: 'Poppins', sans-serif; font-size: 13px; font-weight: 600;
  }
  .stat-icon { font-size: 18px; }
  .stat-value { color: var(--gold); }
  .stat-unit { color: var(--text-muted); font-size: 10px; }

  .level-badge {
    background: var(--accent-pink);
    border: none; border-radius: 25px;
    padding: 4px 14px;
    font-family: 'Poppins', sans-serif; font-size: 12px; font-weight: 700;
    color: white;
  }

  .xp-bar-container {
    width: 120px; height: 12px; background: #161616;
    border-radius: 6px; border: 1px solid var(--panel-border); overflow: hidden;
  }
  .xp-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-pink), var(--neon-blue));
    border-radius: 6px; transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* MAIN LAYOUT */
  .main-container {
    display: grid; grid-template-columns: 340px 1fr;
    height: calc(100vh - 62px); position: relative; z-index: 1;
  }

  /* SIDEBAR */
  .sidebar {
    background: var(--dark-bg);
    border-right: 1px solid var(--panel-border);
    overflow-y: auto; display: flex; flex-direction: column;
    scrollbar-width: thin; scrollbar-color: var(--accent-pink) var(--dark-bg);
  }
  .sidebar::-webkit-scrollbar { width: 6px; }
  .sidebar::-webkit-scrollbar-track { background: var(--dark-bg); }
  .sidebar::-webkit-scrollbar-thumb { background: var(--accent-pink); border-radius: 3px; }

  .sensei-panel {
    padding: 15px; border-bottom: 1px solid var(--panel-border);
    text-align: center;
    background: var(--panel-bg);
    flex-shrink: 0;
  }
  .sensei-avatar {
    font-size: 64px; display: block; margin-bottom: 5px;
    transition: transform 0.3s;
    line-height: 1;
  }
  .sensei-avatar svg { width: 80px; height: 80px; display: inline-block; vertical-align: middle; }
  .sensei-avatar.celebrate { animation: senseiCelebrate 0.6s ease-out; }
  @keyframes senseiCelebrate {
    0% { transform: scale(1) rotate(0); }
    25% { transform: scale(1.2) rotate(-10deg); }
    50% { transform: scale(1.1) rotate(10deg); }
    75% { transform: scale(1.15) rotate(-5deg); }
    100% { transform: scale(1) rotate(0); }
  }
  .sensei-speech {
    background: var(--panel-border); color: var(--text-light); border-radius: 15px;
    padding: 8px 12px; font-size: 13px; font-weight: 600;
    position: relative; margin-top: 5px;
    min-height: 36px; display: flex; align-items: center; justify-content: center;
  }
  .sensei-speech::before {
    content: ''; position: absolute; top: -8px; left: 50%;
    transform: translateX(-50%);
    border-left: 8px solid transparent; border-right: 8px solid transparent;
    border-bottom: 8px solid var(--panel-border);
  }
  .rank-display { font-size: 11px; color: var(--text-muted); text-align: center; margin-top: 4px; }

  .sidebar-content { flex: 1; overflow-y: auto; padding: 8px; }

  /* SECTION HEADERS (collapsible) */
  .sidebar-section-header {
    display: flex; align-items: center; gap: 10px;
    padding: 14px 16px;
    margin: 6px 0;
    font-family: 'Poppins', sans-serif;
    font-size: 14px;
    font-weight: 700;
    color: var(--text-light);
    background: linear-gradient(135deg, rgba(231,94,141,0.12) 0%, rgba(91,192,222,0.08) 100%);
    border-radius: 16px;
    cursor: pointer;
    user-select: none;
    transition: all 0.2s;
  }
  .sidebar-section-header:hover { background: linear-gradient(135deg, rgba(231,94,141,0.2) 0%, rgba(91,192,222,0.14) 100%); }
  .sidebar-section-header .section-chevron {
    font-size: 16px;
    transition: transform 0.25s;
    color: var(--accent-pink);
    flex-shrink: 0;
  }
  .sidebar-section-header.collapsed .section-chevron { transform: rotate(-90deg); }
  .sidebar-section-header .section-label { flex: 1; }
  .sidebar-section-header .section-count {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-muted);
    background: rgba(255,255,255,0.06);
    padding: 2px 8px;
    border-radius: 10px;
  }
  .sidebar-section-body { overflow: hidden; }
  .sidebar-section-body.collapsed { display: none; }
  .sidebar-section-empty {
    padding: 16px 20px;
    font-size: 12px;
    color: var(--text-muted);
    font-style: italic;
    text-align: center;
  }

  /* EXAM CONTEXT BANNER */
  .exam-context {
    background: linear-gradient(135deg, rgba(231,94,141,0.08), rgba(91,192,222,0.06));
    border: 1px solid rgba(231,94,141,0.2);
    border-radius: 10px;
    padding: 10px 14px;
    margin-bottom: 12px;
    font-size: 12px;
    line-height: 1.5;
    color: var(--text-muted);
  }
  .exam-context strong {
    color: var(--neon-blue);
    font-weight: 700;
  }
  .exam-context .exam-tag {
    display: inline-block;
    background: var(--accent-pink);
    color: white;
    font-size: 10px;
    font-weight: 700;
    padding: 2px 8px;
    border-radius: 6px;
    margin-bottom: 6px;
    letter-spacing: 0.5px;
  }

  /* CHAPTER LIST */
  .chapter-item {
    display: flex; align-items: center; gap: 10px;
    padding: 15px 20px; margin-bottom: 6px; border-radius: 23px;
    cursor: pointer; transition: all 0.2s;
    background: var(--panel-bg); position: relative;
  }
  .chapter-item:hover { background: #2f3132; }
  .chapter-item.all-done { border-left: 3px solid var(--success-green); }
  .ch-icon { min-width: 32px; display: flex; align-items: center; justify-content: center; }
  .ch-icon svg { width: 32px; height: 32px; }
  .ch-num {
    font-family: 'Poppins', sans-serif; font-size: 11px; font-weight: 600;
    color: var(--neon-blue); min-width: 30px;
  }
  .ch-info { flex: 1; min-width: 0; }
  .ch-title { font-size: 13px; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .ch-progress-row { display: flex; align-items: center; gap: 8px; margin-top: 4px; }
  .ch-progress-bar { flex: 1; height: 6px; background: #161616; border-radius: 3px; overflow: hidden; }
  .ch-progress-fill {
    height: 100%; border-radius: 3px; transition: width 0.5s;
    background: linear-gradient(90deg, var(--accent-pink), var(--accent-pink-light));
  }
  .ch-progress-text { font-size: 10px; color: var(--text-muted); min-width: 36px; text-align: right; }
  .ch-points-earned {
    font-family: 'Poppins', sans-serif; font-size: 11px; font-weight: 600;
    color: var(--gold);
    min-width: 50px; text-align: right;
  }

  /* BACK BUTTON */
  .back-btn {
    display: flex; align-items: center; gap: 8px;
    padding: 10px 12px; margin-bottom: 8px;
    font-size: 13px; font-weight: 600; color: var(--neon-blue);
    cursor: pointer; border-radius: 25px; transition: all 0.2s;
    border: none; background: var(--panel-bg); width: 100%;
  }
  .back-btn:hover { background: #2f3132; }

  .ch-header-info {
    padding: 8px 12px 12px; margin-bottom: 8px;
    border-bottom: 1px solid var(--panel-border);
  }
  .ch-header-icon { display: inline-block; vertical-align: middle; margin-right: 8px; }
  .ch-header-icon svg { width: 28px; height: 28px; vertical-align: middle; }
  .ch-header-title {
    font-family: 'Poppins', sans-serif; font-size: 18px; font-weight: 700;
    color: var(--accent-pink);
  }
  .ch-header-progress { display: flex; align-items: center; gap: 8px; margin-top: 6px; }
  .ch-header-bar { flex: 1; height: 8px; background: #161616; border-radius: 4px; overflow: hidden; }
  .ch-header-fill {
    height: 100%; border-radius: 4px; transition: width 0.5s;
    background: linear-gradient(90deg, var(--accent-pink), var(--accent-pink-light));
  }
  .ch-header-text { font-size: 11px; color: var(--text-muted); }

  /* CHALLENGE ITEMS (inside chapter drill-down) */
  .challenge-item {
    display: flex; align-items: center; gap: 10px;
    padding: 10px 12px; margin-bottom: 4px; border-radius: 15px;
    cursor: pointer; transition: all 0.2s;
    border: 2px solid transparent; position: relative;
  }
  .challenge-item:hover { background: var(--panel-bg); }
  .challenge-item.active {
    background: var(--panel-bg); border-left: 3px solid var(--accent-pink);
  }
  .challenge-item.completed { opacity: 0.7; }
  .challenge-item.completed .ci-status { color: var(--success-green); }

  .ci-num { font-family: 'Poppins', sans-serif; font-size: 11px; font-weight: 600; color: var(--text-muted); min-width: 24px; }
  .ci-status { font-size: 18px; min-width: 22px; text-align: center; }
  .ci-info { flex: 1; min-width: 0; }
  .ci-name { font-size: 13px; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .ci-diff { font-size: 10px; opacity: 0.6; margin-top: 2px; }
  .ci-points {
    font-family: 'Poppins', sans-serif; font-size: 11px; font-weight: 600;
    color: var(--gold); white-space: nowrap;
  }
  .diff-star { color: var(--neon-yellow); font-size: 10px; }

  /* PROGRESS SECTION */
  .progress-section {
    padding: 12px 15px; border-top: 1px solid var(--panel-border);
    background: var(--panel-bg); flex-shrink: 0;
  }
  .progress-label {
    font-family: 'Poppins', sans-serif; font-size: 11px; font-weight: 600;
    color: var(--text-muted); margin-bottom: 6px; display: flex; justify-content: space-between;
  }
  .progress-bar { height: 8px; background: #161616; border-radius: 4px; overflow: hidden; }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-pink), var(--accent-pink-light));
    border-radius: 4px; transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* EDITOR AREA */
  .editor-area { display: flex; flex-direction: column; overflow: hidden; }

  .challenge-header {
    background: var(--panel-bg);
    border-bottom: 1px solid var(--panel-border);
    padding: 12px 20px; flex-shrink: 0;
  }
  .challenge-title { font-family: 'Poppins', sans-serif; font-size: 20px; font-weight: 700; color: var(--accent-pink); }
  .challenge-desc { font-size: 13px; margin-top: 4px; line-height: 1.5; color: var(--text-muted); overflow-wrap: break-word; }
  .challenge-desc code { word-break: break-all; }
  .challenge-hint { font-size: 12px; color: var(--neon-blue); margin-top: 6px; font-style: italic; opacity: 0.8; }
  .challenge-points-display { font-family: 'Poppins', sans-serif; font-size: 13px; font-weight: 600; color: var(--gold); margin-top: 6px; }

  .editor-console-split { flex: 1; display: grid; grid-template-rows: 1fr 200px; overflow: hidden; }

  .editor-panel { position: relative; border-bottom: 1px solid var(--panel-border); }
  .editor-tab-bar {
    display: flex; align-items: center; justify-content: space-between;
    background: #161616; padding: 0 10px; height: 36px;
    border-bottom: 1px solid var(--panel-border);
  }
  .editor-tab { font-family: 'Fira Code', monospace; font-size: 12px; color: var(--neon-blue); display: flex; align-items: center; gap: 6px; }

  .btn-group { display: flex; gap: 6px; }
  .btn {
    font-family: 'Poppins', sans-serif; font-size: 11px; font-weight: 600;
    padding: 6px 16px; border: none; border-radius: 25px;
    cursor: pointer; transition: all 0.2s; text-transform: uppercase;
  }
  .btn-run {
    background: var(--accent-pink); color: white;
  }
  .btn-run:hover { background: var(--accent-pink-light); box-shadow: 0 0 10px rgba(231,94,141,0.3); transform: translateY(-1px); }
  .btn-run:active { transform: translateY(1px); }
  .btn-reset { background: var(--panel-border); color: #ccc; }
  .btn-reset:hover { background: #444; }
  .btn-hint {
    background: var(--panel-border); color: #ccc;
  }
  .btn-hint:hover { background: #444; }

  #codeEditor {
    width: 100%; height: calc(100% - 36px);
    background: var(--dark-bg); color: #e0e0e0;
    font-family: 'Fira Code', monospace; font-size: 14px; line-height: 1.6;
    padding: 15px; border: none; outline: none; resize: none; tab-size: 4;
  }
  #codeEditor::selection { background: rgba(231,94,141,0.3); }

  .console-panel { background: #161616; display: flex; flex-direction: column; }
  .console-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 10px; height: 30px; background: #111;
    border-bottom: 1px solid var(--panel-border);
    font-family: 'Fira Code', monospace; font-size: 12px; color: var(--success-green);
  }
  .console-clear { cursor: pointer; color: var(--text-muted); font-size: 11px; border: none; background: none; font-family: inherit; }
  .console-clear:hover { color: #aaa; }

  #consoleOutput {
    flex: 1; padding: 10px 15px;
    font-family: 'Fira Code', monospace; font-size: 13px; line-height: 1.5;
    overflow-y: auto; white-space: pre-wrap; word-break: break-all;
  }
  .console-line { margin-bottom: 2px; }
  .console-line.error { color: #ff5252; }
  .console-line.success { color: var(--success-green); }
  .console-line.info { color: var(--neon-blue); }
  .console-line.output { color: #e0e0e0; }

  /* OVERLAYS */
  .overlay {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.8);
    display: flex; align-items: center; justify-content: center;
    z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.3s;
  }
  .overlay.active { opacity: 1; pointer-events: all; }

  .success-popup {
    background: var(--panel-bg);
    border: 2px solid var(--success-green); border-radius: 23px;
    padding: 30px 40px; text-align: center;
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
    transform: scale(0.8); transition: transform 0.3s; max-width: 400px;
  }
  .overlay.active .success-popup { transform: scale(1); animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
  @keyframes popIn {
    0% { transform: scale(0.5) rotate(-5deg); }
    60% { transform: scale(1.1) rotate(2deg); }
    100% { transform: scale(1) rotate(0); }
  }

  .success-emoji { font-size: 64px; margin-bottom: 10px; animation: bounceEmoji 0.6s ease-out; }
  @keyframes bounceEmoji { 0% { transform: translateY(-30px); opacity: 0; } 60% { transform: translateY(5px); } 100% { transform: translateY(0); opacity: 1; } }
  .success-title { font-family: 'Poppins', sans-serif; font-size: 28px; font-weight: 700; color: var(--success-green); }
  .success-points { font-family: 'Poppins', sans-serif; font-size: 20px; font-weight: 700; color: var(--gold); margin: 10px 0; }
  .success-msg { font-size: 14px; color: var(--text-muted); margin-bottom: 15px; }
  .btn-next {
    background: var(--accent-pink); border: none; border-radius: 25px;
    padding: 10px 30px; color: white;
    font-family: 'Poppins', sans-serif; font-size: 13px; font-weight: 600;
    cursor: pointer; transition: all 0.2s;
  }
  .btn-next:hover { background: var(--accent-pink-light); transform: translateY(-2px); box-shadow: 0 0 10px rgba(231,94,141,0.3); }

  .combo-display {
    position: fixed; top: 80px; right: 20px;
    font-family: 'Poppins', sans-serif; font-size: 22px; font-weight: 700;
    color: var(--accent-pink);
    opacity: 0; transform: scale(0.5); transition: all 0.3s; z-index: 50; pointer-events: none;
  }
  .combo-display.active { opacity: 1; transform: scale(1); }

  .particle {
    position: fixed; pointer-events: none; z-index: 200; font-size: 24px;
    animation: particleFloat 1.5s ease-out forwards;
  }
  @keyframes particleFloat { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-100px) scale(0.5); } }

  .level-up-flash {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(circle, rgba(255,215,0,0.15), transparent 70%);
    z-index: 90; opacity: 0; pointer-events: none;
  }
  .level-up-flash.active { animation: levelFlash 1s ease-out; }
  @keyframes levelFlash { 0% { opacity: 1; } 100% { opacity: 0; } }

  .achievement-toast {
    position: fixed; bottom: calc(20px + env(safe-area-inset-bottom, 0px)); left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--panel-bg);
    border: 2px solid var(--gold); border-radius: 23px;
    padding: 12px 24px; display: flex; align-items: center; gap: 12px;
    z-index: 150; box-shadow: 0 0 15px rgba(0,0,0,0.3);
    transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  .achievement-toast.show { transform: translateX(-50%) translateY(0); }
  .achievement-toast .ach-icon { font-size: 28px; }
  .achievement-toast .ach-text { font-family: 'Poppins', sans-serif; font-size: 11px; font-weight: 600; color: var(--gold); line-height: 1.6; }
  .achievement-toast .ach-name { font-size: 13px; color: white; }

  /* Scrollbars */
  #codeEditor::-webkit-scrollbar { width: 8px; }
  #codeEditor::-webkit-scrollbar-track { background: var(--dark-bg); }
  #codeEditor::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
  #consoleOutput::-webkit-scrollbar { width: 6px; }
  #consoleOutput::-webkit-scrollbar-track { background: #161616; }
  #consoleOutput::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }

  /* HERO SPLASH */
  .hero-splash {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    flex: 1; padding: 40px 20px; text-align: center; gap: 24px;
    animation: heroFadeIn 0.6s ease-out;
  }
  @keyframes heroFadeIn { 0% { opacity: 0; transform: translateY(20px); } 100% { opacity: 1; transform: translateY(0); } }

  .hero-mascot { width: 180px; height: 180px; filter: drop-shadow(0 0 20px rgba(231,94,141,0.3)); }

  .hero-title {
    font-family: 'Poppins', sans-serif; font-size: 56px; font-weight: 900;
    background: linear-gradient(135deg, var(--accent-pink), var(--neon-blue));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    letter-spacing: 8px; line-height: 1;
  }
  .hero-subtitle {
    font-family: 'Poppins', sans-serif; font-size: 16px; font-weight: 600;
    color: var(--text-muted); letter-spacing: 2px;
  }

  .hero-stats {
    display: flex; gap: 16px; margin-top: 8px;
  }
  .hero-stat-card {
    background: var(--panel-bg); border: 1px solid var(--panel-border);
    border-radius: 16px; padding: 16px 24px; min-width: 120px;
    transition: transform 0.2s, border-color 0.2s;
  }
  .hero-stat-card:hover { transform: translateY(-3px); border-color: var(--accent-pink); }
  .hero-stat-value {
    font-family: 'Poppins', sans-serif; font-size: 28px; font-weight: 900;
    color: var(--accent-pink);
  }
  .hero-stat-label {
    font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase;
    letter-spacing: 1px; margin-top: 2px;
  }

  .hero-cta {
    background: var(--accent-pink); border: none; border-radius: 30px;
    padding: 14px 36px; color: white;
    font-family: 'Poppins', sans-serif; font-size: 15px; font-weight: 700;
    cursor: pointer; transition: all 0.2s; text-transform: uppercase;
    letter-spacing: 1px; margin-top: 8px;
    box-shadow: 0 4px 20px rgba(231,94,141,0.3);
  }
  .hero-cta:hover {
    background: var(--accent-pink-light); transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(231,94,141,0.4);
  }
  .hero-cta:active { transform: translateY(1px); }

  /* AUTH SECTION */
  .auth-section { display: flex; align-items: center; margin-left: 8px; }
  .btn-signin {
    display: flex; align-items: center; gap: 8px;
    background: var(--panel-border); color: var(--text-light);
    border: none; border-radius: 25px; padding: 6px 16px;
    font-family: 'Poppins', sans-serif; font-size: 12px; font-weight: 600;
    cursor: pointer; transition: all 0.2s;
  }
  .btn-signin:hover { background: #444; }
  .btn-signin svg { width: 16px; height: 16px; }
  .user-profile {
    display: none; align-items: center; gap: 8px;
  }
  .user-profile.visible { display: flex; }
  .user-avatar {
    width: 30px; height: 30px; border-radius: 50%;
    border: 2px solid var(--accent-pink);
  }
  .user-name {
    font-family: 'Poppins', sans-serif; font-size: 12px; font-weight: 600;
    color: var(--text-light); max-width: 100px;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .btn-signout {
    background: none; border: none; color: var(--text-muted);
    font-size: 16px; cursor: pointer; padding: 2px 6px;
    line-height: 1; transition: color 0.2s;
  }
  .btn-signout:hover { color: var(--accent-pink); }

  .mobile-back-btn {
    display: none;
    background: var(--panel-border); color: var(--neon-blue);
    border: none; border-radius: 20px; padding: 6px 14px;
    font-family: 'Poppins', sans-serif; font-size: 12px; font-weight: 600;
    cursor: pointer; margin-bottom: 8px;
  }
  .mobile-back-btn:active { background: #444; }

  @media (max-width: 900px) {
    .mobile-back-btn { display: inline-block; }
    .header { position: sticky; top: 0; z-index: 20; }
    .main-container { display: flex; flex-direction: column; height: auto; overflow-x: hidden; }
    .sidebar { max-height: 250px; border-right: none; border-bottom: 1px solid var(--panel-border); overflow-y: auto; }

    .editor-area { overflow: visible; }
    .editor-console-split { display: flex; flex-direction: column; overflow: visible; }
    .editor-panel { height: 250px; }
    #codeEditor { height: calc(100% - 36px); }
    .console-panel { height: 150px; }
    #consoleOutput { overflow-y: auto; }

    .hero-splash { padding: 24px 16px; gap: 16px; }
    .hero-title { font-size: 36px; letter-spacing: 4px; }
    .hero-mascot { width: 120px; height: 120px; }
    .hero-stats { flex-wrap: wrap; justify-content: center; gap: 10px; }
    .hero-stat-card { min-width: 90px; padding: 12px 16px; }
    .hero-stat-value { font-size: 22px; }

    .user-name { display: none; }
    .btn-signin span { display: none; }
    .btn-signin { padding: 6px 10px; }
  }

  @media (max-width: 600px) {
    .header { padding: 8px 12px; }
    .logo-icon { font-size: 24px; }
    .logo-text { font-size: 20px; letter-spacing: 2px; }
    .logo-sub { font-size: 8px; letter-spacing: 2px; }
    .stats-bar { gap: 6px; flex-wrap: wrap; justify-content: flex-end; }
    .stat-item { font-size: 11px; gap: 3px; }
    .stat-icon { font-size: 14px; }
    .level-badge { font-size: 10px; padding: 3px 10px; }
    .xp-bar-container { width: 60px; height: 8px; }

    .sidebar { max-height: 250px; }
    .sensei-panel { display: none; }
    .progress-section { display: none; }
    .sidebar-section-header { padding: 10px 12px; font-size: 12px; }
    .chapter-item { padding: 10px 12px; }
    .ch-title { font-size: 12px; }
    .ch-icon svg { width: 24px; height: 24px; }

    .challenge-header { padding: 10px 14px; }
    .challenge-title { font-size: 16px; }
    .challenge-desc { font-size: 12px; }
    .editor-tab-bar { padding: 0 6px; height: 40px; }
    .editor-tab { font-size: 0; } .editor-tab span { font-size: 14px; }
    .btn { font-size: 10px; padding: 6px 14px; min-height: 32px; }
    .btn-group { gap: 4px; }
    .editor-panel { height: 220px; }
    #codeEditor { font-size: 16px; padding: 10px; line-height: 1.5; }
    .console-panel { height: 120px; }
    #consoleOutput { font-size: 16px; padding: 8px 10px; }

    .success-popup { padding: 20px 24px; margin: 16px; }
    .success-title { font-size: 22px; }
    .success-emoji { font-size: 48px; }
    .success-points { font-size: 16px; }

    .hero-splash { padding: 16px 12px; gap: 10px; }
    .hero-title { font-size: 28px; letter-spacing: 3px; }
    .hero-subtitle { font-size: 12px; }
    .hero-mascot { width: 60px; height: 60px; }
    .hero-stats { display: none; }
    .hero-cta { padding: 12px 28px; font-size: 13px; }
  }

  /* FOCUS VISIBLE */
  :focus-visible {
    outline: 2px solid var(--neon-blue);
    outline-offset: 2px;
  }
  button:focus-visible, .btn:focus-visible, .hero-cta:focus-visible, .btn-next:focus-visible {
    outline: 2px solid var(--neon-blue);
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(91,192,222,0.25);
  }
  #codeEditor:focus-visible { outline: none; box-shadow: inset 0 0 0 2px rgba(91,192,222,0.3); }

  /* REDUCED MOTION */
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* MOBILE: touch targets + view switching */
  @media (max-width: 900px) {
    .sidebar.mobile-hidden { display: none; }
  }
  @media (max-width: 600px) {
    .btn { min-height: 44px; padding: 10px 14px; display: inline-flex; align-items: center; justify-content: center; }
    .mobile-back-btn { min-height: 44px; padding: 10px 18px; font-size: 14px; }
    .btn-signout { min-width: 44px; min-height: 44px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
    .console-clear { min-height: 44px; padding: 0 12px; }
    .challenge-item { padding: 14px 12px; min-height: 48px; }
    .back-btn { min-height: 44px; }
    .chapter-item { min-height: 48px; }
  }
</style>
</head>
<body>

<div class="level-up-flash" id="levelUpFlash"></div>
<div class="combo-display" id="comboDisplay"></div>

<div class="header">
  <div class="logo" onclick="goHome()">
    <span class="logo-icon">&#x1F40D;</span>
    <div>
      <div class="logo-text">RONNY</div>
      <div class="logo-sub">LC Python Challenges</div>
    </div>
  </div>
  <div class="stats-bar">
    <div class="level-badge" id="levelBadge">LV 1</div>
    <div class="stat-item">
      <span class="stat-icon">&#x2B50;</span>
      <span class="stat-value" id="totalXP">0</span>
      <span class="stat-unit">XP</span>
    </div>
    <div class="xp-bar-container">
      <div class="xp-bar-fill" id="xpBarFill" style="width:0%"></div>
    </div>
    <div class="stat-item" title="Daily streak">
      <span class="stat-icon">&#x1F525;</span>
      <span class="stat-value" id="streakCount">0</span>
      <span class="stat-unit">days</span>
    </div>
    <div class="stat-item">
      <span class="stat-icon">&#x1F3C6;</span>
      <span class="stat-value" id="completedCount">0</span>
      <span class="stat-unit" id="totalChallenges">/296</span>
    </div>
    <div class="auth-section" id="authSection">
      <button class="btn-signin" id="btnSignIn" onclick="signInWithGoogle()">
        <svg viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>
        <span>Sign In</span>
      </button>
      <div class="user-profile" id="userProfile">
        <img class="user-avatar" id="userAvatar" src="" alt="avatar">
        <span class="user-name" id="userName"></span>
        <button class="btn-signout" id="btnSignOut" onclick="signOutUser()" title="Sign out">&times;</button>
      </div>
    </div>
  </div>
</div>

<div class="main-container">
  <div class="sidebar">
    <div class="sensei-panel">
      <span class="sensei-avatar" id="senseiAvatar"><svg viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg"><polygon points="30,18 34,8 38,16 40,6 42,16 46,8 50,18" fill="#ffd700" stroke="#e6a800" stroke-width="1"/><ellipse cx="40" cy="26" rx="12" ry="10" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2"/><circle cx="36" cy="24" r="2.5" fill="#e75e8d"/><circle cx="36" cy="23.5" r="1" fill="white"/><circle cx="44" cy="24" r="2.5" fill="#e75e8d"/><circle cx="44" cy="23.5" r="1" fill="white"/><path d="M40 32 L39 36 M40 32 L41 36" stroke="#e75e8d" stroke-width="1" stroke-linecap="round"/><rect x="30" y="35" width="20" height="9" rx="4.5" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2"/><rect x="26" y="43" width="22" height="9" rx="4.5" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2"/><rect x="30" y="51" width="24" height="9" rx="4.5" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2"/><path d="M54 55 Q60 52 62 46" stroke="#e75e8d" stroke-width="2" fill="none" stroke-linecap="round"/></svg></span>
      <div class="rank-display" id="rankDisplay">Rank: Beginner</div>
      <div class="sensei-speech" id="senseiSpeech">Welcome! Choose a chapter to start!</div>
    </div>
    <div class="sidebar-content" id="sidebarContent"></div>
    <div class="progress-section">
      <div class="progress-label">
        <span>TOTAL MASTERY</span>
        <span id="progressPercent">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width:0%"></div>
      </div>
    </div>
  </div>

  <div class="editor-area">
    <div class="hero-splash" id="heroSplash">
      <svg class="hero-mascot" viewBox="0 0 180 180" fill="none" xmlns="http://www.w3.org/2000/svg">
        <!-- Crown -->
        <polygon points="72,38 78,22 84,34 90,18 96,34 102,22 108,38" fill="#ffd700" stroke="#e6a800" stroke-width="1.5"/>
        <!-- Head -->
        <ellipse cx="90" cy="52" rx="22" ry="18" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2.5"/>
        <!-- Eyes -->
        <circle cx="82" cy="48" r="4" fill="#e75e8d"/><circle cx="82" cy="47" r="1.5" fill="white"/>
        <circle cx="98" cy="48" r="4" fill="#e75e8d"/><circle cx="98" cy="47" r="1.5" fill="white"/>
        <!-- Tongue -->
        <path d="M90 64 L88 72 M90 64 L92 72" stroke="#e75e8d" stroke-width="1.5" stroke-linecap="round"/>
        <!-- Body segments (coiled) -->
        <rect x="72" y="68" width="36" height="16" rx="8" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2.5"/>
        <rect x="60" y="82" width="40" height="16" rx="8" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2.5"/>
        <rect x="72" y="96" width="44" height="16" rx="8" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2.5"/>
        <rect x="56" y="110" width="48" height="16" rx="8" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2.5"/>
        <rect x="66" y="124" width="52" height="16" rx="8" fill="#2d2d2d" stroke="#e75e8d" stroke-width="2.5"/>
        <!-- Tail -->
        <path d="M118 132 Q130 128 134 118 Q138 108 130 102" stroke="#e75e8d" stroke-width="2.5" fill="none" stroke-linecap="round"/>
        <!-- Belly pattern stripes -->
        <line x1="82" y1="72" x2="98" y2="72" stroke="#3a3a3a" stroke-width="1" opacity="0.6"/>
        <line x1="72" y1="88" x2="92" y2="88" stroke="#3a3a3a" stroke-width="1" opacity="0.6"/>
        <line x1="82" y1="102" x2="108" y2="102" stroke="#3a3a3a" stroke-width="1" opacity="0.6"/>
        <line x1="68" y1="116" x2="96" y2="116" stroke="#3a3a3a" stroke-width="1" opacity="0.6"/>
        <line x1="78" y1="130" x2="110" y2="130" stroke="#3a3a3a" stroke-width="1" opacity="0.6"/>
        <!-- Pixel-style accent dots -->
        <circle cx="76" cy="75" r="1.5" fill="#5bc0de" opacity="0.5"/>
        <circle cx="64" cy="89" r="1.5" fill="#5bc0de" opacity="0.5"/>
        <circle cx="112" cy="103" r="1.5" fill="#5bc0de" opacity="0.5"/>
        <circle cx="100" cy="117" r="1.5" fill="#5bc0de" opacity="0.5"/>
      </svg>
      <div class="hero-title">RONNY</div>
      <div class="hero-subtitle">Python Challenges for Leaving Cert Curriculum</div>
      <div class="hero-stats">
        <div class="hero-stat-card">
          <div class="hero-stat-value" id="heroTotalChallenges">296</div>
          <div class="hero-stat-label">Challenges</div>
        </div>
        <div class="hero-stat-card">
          <div class="hero-stat-value">41</div>
          <div class="hero-stat-label">Chapters</div>
        </div>
        <div class="hero-stat-card">
          <div class="hero-stat-value" id="heroXP">0</div>
          <div class="hero-stat-label">XP Earned</div>
        </div>
      </div>
      <button class="hero-cta" id="heroCta" onclick="heroChooseChapter()">Start Coding &#x2192;</button>
      <a href="https://github.com/darraghdog/ronny" target="_blank" rel="noopener" style="margin-top:4px;font-size:12px;color:var(--text-muted);text-decoration:none;letter-spacing:1px;font-weight:600;">Free &amp; Open Source &#x2197;</a>
    </div>

    <div class="challenge-header" id="challengeHeader">
      <button class="mobile-back-btn" id="mobileBackBtn" onclick="mobileBack()">&#x2190; Back</button>
      <div class="challenge-title" id="challengeTitle">Select a Challenge</div>
      <div class="challenge-desc" id="challengeDesc">Choose a chapter from the sidebar, then pick a challenge to begin!</div>
      <div class="challenge-hint" id="challengeHint"></div>
      <div class="challenge-points-display" id="challengePoints"></div>
    </div>
    <div class="editor-console-split" id="editorConsoleSplit">
      <div class="editor-panel">
        <div class="editor-tab-bar">
          <div class="editor-tab"><span>&#x1F40D;</span> solution.py</div>
          <div class="btn-group">
            <button class="btn btn-hint" onclick="showHint()" title="Show hint">HINT</button>
            <button class="btn btn-reset" onclick="resetCode()">RESET</button>
            <button class="btn btn-run" onclick="runCode()" title="Ctrl+Enter">&#x25B6; RUN</button>
          </div>
        </div>
        <textarea id="codeEditor" spellcheck="false" placeholder="# Write your Python code here...&#10;# Press Ctrl+Enter or click RUN to execute"></textarea>
      </div>
      <div class="console-panel">
        <div class="console-header">
          <span>&#x1F4DF; CONSOLE OUTPUT</span>
          <button class="console-clear" onclick="clearConsole()">CLEAR</button>
        </div>
        <div id="consoleOutput"></div>
      </div>
    </div>
  </div>
</div>

<div class="overlay" id="successOverlay">
  <div class="success-popup">
    <div class="success-emoji" id="successEmoji">&#x1F389;</div>
    <div class="success-title" id="successTitle">CHALLENGE CLEAR!</div>
    <div class="success-points" id="successPoints">+100 XP</div>
    <div class="success-msg" id="successMsg">Great work!</div>
    <button class="btn-next" id="btnNext" onclick="nextChallenge()">NEXT CHALLENGE &#x27A1;</button>
  </div>
</div>

<div class="achievement-toast" id="achievementToast">
  <span class="ach-icon" id="achIcon">&#x1F3C5;</span>
  <div>
    <div class="ach-text">ACHIEVEMENT UNLOCKED</div>
    <div class="ach-name" id="achName">First Steps</div>
  </div>
</div>


<script src="challenges.js"></script>
<script src="engine.js"></script>
</body>
</html>
